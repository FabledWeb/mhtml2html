"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function t(e,t){if(!e)throw new Error(t)}function n(e){var t=/[\\\"\x00-\x1f\x7f-\uffff]/g,n={"\b":"\b","\t":"\t","\n":"\n","\f":"\f","\r":"\r",'"':'"',"\\":"\\"};return t.lastIndex=0,t.test(e)?e.replace(t,function(e){var t=n[e];return"string"==typeof t?t:"\\"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}):e}var o=void 0;"undefined"!=typeof require&&(o=require);var r="url(",i="        /* MyCache CSS Reset:  */                                /* http://meyerweb.com/eric/tools/css/reset/ */          html, body, div, span, applet, object, iframe,           blockquote, pre,                                         a, abbr, acronym, address, big, cite, code,              del, dfn, em, img, ins, kbd, q, s, samp,                 small, strike, strong, sub, sup, tt, var,                b, u, i, center,                                         dl, dt, dd, ol, ul, li,                                  fieldset, form, label, legend,                           table, caption, tbody, tfoot, thead, tr, th, td,         article, aside, canvas, details, embed,                  figure, figcaption, footer, header, hgroup,              menu, nav, output, ruby, section, summary,               time, mark, audio, video {                                   margin: 0;                                               padding: 0;                                              border: 0;                                               font-size: 100%;                                         font: inherit;                                           vertical-align: baseline;                            }                                                        h1, h2, h3, h4, h5, h6, p {                                  padding: 0;                                              border: 0;                                               font-size: 100%;                                         font: inherit;                                           vertical-align: baseline;                            }                                                        article, aside, details, figcaption, figure,             footer, header, hgroup, menu, nav, section {                 display: block;                                      }                                                        body {                                                       line-height: 1;                                      }                                                        ol, ul {                                                     list-style: none;                                    }                                                        blockquote, q {                                              quotes: none;                                        }                                                        blockquote:before, blockquote:after,                     q:before, q:after {                                          content: '';                                           content: none;                                       }                                                        strong, b {                                                  font-weight: bold;                                   }                                                        table {                                                      border-collapse: collapse;                               border-spacing: 0;                                   }",d=void 0,a=void 0;void 0!=e&&(d=e.mhtml2html),a=function(){var e=String.fromCharCode,t=function(t){return t.replace(/[\t\x20]$/gm,"").replace(/=(?:\r\n?|\n|$)/g,"").replace(/=([a-fA-F0-9]{2})/g,function(t,n){var o=parseInt(n,16);return e(o)})},n=function(e){return e.replace(/\x20$/,"=20").replace(/\t$/,"=09")},o=/[\0-\x08\n-\x1F=\x7F-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,r=function(e){for(var t=e.replace(o,function(e){if(e>"ÿ")throw RangeError("`quotedPrintable.encode()` expects extended ASCII input only. Don’t forget to encode the input first using a character encoding like UTF-8.");var t=e.charCodeAt(0),n=t.toString(16).toUpperCase();return"="+("0"+n).slice(-2)}),r=t.split(/\r\n?|\n/g),i=-1,d=r.length,a=[];++i<d;)for(var f=r[i],s=75,l=0,u=f.length;l<u;){var c=t.slice(l,l+s);/=$/.test(c)?(c=c.slice(0,s-1),l+=s-1):/=[A-F0-9]$/.test(c)?(c=c.slice(0,s-2),l+=s-2):l+=s,a.push(c)}var p=c.length;return/[\t\x20]$/.test(c)&&(a.pop(),p+2<=s+1?a.push(n(c)):a.push(c.slice(0,p-1),n(c.slice(p-1,p)))),a.join("=\r\n")};return{encode:r,decode:t,version:"1.0.0"}}();var f={noConflict:function(){return e.mhtml2html=d,f},parse:function(e){function n(){for(;t(x<e.length-1,"Unexpected EOF"),/\s/.test(e[x]);)x++,"\n"==e[x]&&_++}function r(n){var o;for(T=x;;){if("\n"==e[x]){x++,_++;break}t(x++<e.length-1,"Unexpected EOF")}switch(o=e.substring(T,x),n){case"quoted-printable":return a.decode(o);case"base64":return o.trim();default:return o}}function i(e,n){var o=e.split(/[:=](.+)?/);t(o.length>=2,"Invalid header; Line "+_),n[o[0].trim()]=o[1].trim()}var d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],f={MHTML_HEADERS:0,MTHML_CONTENT:1,MHTML_DATA:2,MHTML_END:3},s=void 0,l=void 0,u=void 0,c=void 0,p=void 0,h=void 0,v=void 0,y=void 0,g=void 0,m=void 0,b=void 0,M=void 0,x=void 0,T=void 0,_=void 0,C=void 0,E=void 0;for(l={},u={},c={},p={},m=f.MHTML_HEADERS,x=_=0;m!=f.MHTML_END;)switch(m){case f.MHTML_HEADERS:b=r(),0!=b&&"\n"!=b?i(b,l):(C=l.boundary,t(void 0!==C,"Missing boundary from document headers; Line "+_),C=C.replace(/\"/g,""),n(),b=r(),t(b.includes(C),"Expected boundary; Line "+_),u={},m=f.MTHML_CONTENT);break;case f.MTHML_CONTENT:b=r(),0!=b&&"\n"!=b?i(b,u):(v=u["Content-Transfer-Encoding"],y=u["Content-Type"],g=u["Content-ID"],h=u["Content-Location"],void 0===M&&(M=h,t(void 0!==M&&"text/html"===y,"Index not found; Line "+_)),t(void 0!==g||void 0!==h,"ID or location header not provided;  Line "+_),t(void 0!==v,"Content-Transfer-Encoding not provided;  Line "+_),t(void 0!==y,"Content-Type not provided; Line "+_),s={encoding:v,type:y,data:"",id:g},void 0!==g&&(p[g]=s),void 0!==h&&void 0===c[h]&&(c[h]=s),n(),u={},m=f.MHTML_DATA);break;case f.MHTML_DATA:for(b=r(v);!b.includes(C);)s.data+=b,b=r(v);try{s.data=decodeURIComponent(escape(s.data))}catch(e){}if(d===!0&&void 0!==M)return"undefined"==typeof DOMParser?(t("undefined"!=typeof o,"Require is not defined."),(E=o("jsdom").jsdom)(s.data,{})):(E=new DOMParser,E.parseFromString(s.data,"text/html"));m=x>=e.length-1?f.MHTML_END:f.MTHML_CONTENT}return{frames:p,media:c,index:M}},convert:function(e){function d(e,t){function n(n){r=e.split("/"),i=t.split("/"),n&&r.pop();for(var o=0;o<i.length;o++)".."==i[o]?r.pop():"."!=i[o]&&r.push(i[o]);return r.join("/")}var o,r,i,d;return/^((http|https|ftp):\/\/)/.test(t)?t:"/"==t[0]?(o=e.match(new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?")),o[2]+"://"+o[4]+t):(d=n(),null==u[d]?n(!0):d)}function a(e,t){var n,o;return h=t.substring(v,t.indexOf(")",v)),v+=h.length,n=d(e,h.replace(/(\"|\')/g,"")),null==u[n]?null:(h="url('data:"+u[n].type+";base64,"+("base64"===u[n].encoding?u[n].data:g(u[n].data))+"')",o=v,v=y+h.length,""+t.substring(0,y)+h+t.substring(o+1))}function s(e){var t,o,d,f,s,c,p,g;for(d=[e],f=e.createElement("style"),f.type="text/css",f.styleSheet?f.styleSheet.cssText=i:f.appendChild(e.createTextNode(i));d.length;){for(t=d.shift(),o=new Array(Object.keys(t.childNodes).length),v=0;v<o.length;v++)o[v]=t.childNodes[v];o.forEach(function(t){if("HEAD"===t.tagName&&(t.insertBefore(f,t.firstChild),s=e.createElement("base"),s.setAttribute("target","_parent"),t.insertBefore(s,t.firstChild)),t.getAttribute){if(c=t.getAttribute("href"),p=t.getAttribute("src"),c&&u[c]){if("text/css"===u[c].type)for(v=0;(v=u[c].data.indexOf(r,v))>0;)y=v,v+=r.length,h=a(c,u[c].data),null!=h&&(u[c].data=h);t.setAttribute("href","data:"+u[c].type+";"+u[c].encoding+","+encodeURIComponent(n(u[c].data)))}p&&u[p]&&t.setAttribute("src","data:"+u[p].type+";"+u[p].encoding+","+encodeURIComponent(u[p].data));for(g in t.style)if(_typeof(t.style[g])===_typeof(""))for(;(v=t.style[g].indexOf(r,v))>0;)y=v,v+=r.length,h=a(l,t.style[g]),null!=h&&(t.style[g]=h)}t.removeAttribute&&t.removeAttribute("integrity"),d.push(t)})}return e}var l,u,c,p,h,v,y;("undefined"==typeof e?"undefined":_typeof(e))===_typeof("")?e=f.parse(e):t(("undefined"==typeof e?"undefined":_typeof(e))===_typeof({}),"Expected argument of type string or object"),c=e.frames,u=e.media,l=e.index,t(("undefined"==typeof c?"undefined":_typeof(c))===_typeof({}),"MHTML error: invalid frames"),t(("undefined"==typeof u?"undefined":_typeof(u))===_typeof({}),"MHTML error: invalid media"),t(("undefined"==typeof l?"undefined":_typeof(l))===_typeof(" "),"MHTML error: invalid index"),t(u[l]&&"text/html"===u[l].type,"MHTML error: invalid index");var g=void 0;return"undefined"==typeof btoa?(t("undefined"!==o,"Require is not defined."),g=o("btoa")):g=btoa,"undefined"==typeof DOMParser?(t("undefined"!=typeof o,"Require is not defined."),p=o("jsdom").jsdom,s(p(u[l].data,{}))):(p=new DOMParser,s(p.parseFromString(u[l].data,"text/html")))}};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=f),exports.mhtml2html=f):void 0!=e&&(e.mhtml2html=f)}("undefined"!=typeof window?window:null);