!function e(t,n,r){function o(d,a){if(!n[d]){if(!t[d]){var u="function"==typeof require&&require;if(!a&&u)return u(d,!0);if(i)return i(d,!0);var f=new Error("Cannot find module '"+d+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[d]={exports:{}};t[d][0].call(c.exports,function(e){var n=t[d][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[d].exports}for(var i="function"==typeof require&&require,d=0;d<r.length;d++)o(r[d]);return o}({1:[function(e,t,n){(function(e){!function(r){var o="object"==typeof n&&n,i="object"==typeof t&&t&&t.exports==o&&t,d="object"==typeof e&&e;d.global!==d&&d.window!==d||(r=d);var a=String.fromCharCode,u=function(e){return e.replace(/[\t\x20]$/gm,"").replace(/=(?:\r\n?|\n|$)/g,"").replace(/=([a-fA-F0-9]{2})/g,function(e,t){var n=parseInt(t,16);return a(n)})},f=function(e){return e.replace(/\x20$/,"=20").replace(/\t$/,"=09")},c=/[\0-\x08\n-\x1F=\x7F-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,s=function(e){for(var t=e.replace(c,function(e){if(e>"ÿ")throw RangeError("`quotedPrintable.encode()` expects extended ASCII input only. Don’t forget to encode the input first using a character encoding like UTF-8.");return"="+("0"+e.charCodeAt(0).toString(16).toUpperCase()).slice(-2)}),n=t.split(/\r\n?|\n/g),r=-1,o=n.length,i=[];++r<o;)for(var d=n[r],a=75,u=0,s=d.length;u<s;){var l=t.slice(u,u+a);/=$/.test(l)?(l=l.slice(0,a-1),u+=a-1):/=[A-F0-9]$/.test(l)?(l=l.slice(0,a-2),u+=a-2):u+=a,i.push(l)}var p=l.length;return/[\t\x20]$/.test(l)&&(i.pop(),p+2<=a+1?i.push(f(l)):i.push(l.slice(0,p-1),f(l.slice(p-1,p)))),i.join("=\r\n")},l={encode:s,decode:u,version:"1.0.1"};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return l});else if(o&&!o.nodeType)if(i)i.exports=l;else for(var p in l)l.hasOwnProperty(p)&&(o[p]=l[p]);else r.quotedPrintable=l}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";function r(e,t){if(!e)throw new Error(t)}function o(e){var t=/[\\\"\x00-\x1f\x7f-\uffff]/g,n={"\b":"\b","\t":"\t","\n":"\n","\f":"\f","\r":"\r",'"':'"',"\\":"\\"};return t.lastIndex=0,t.test(e)?e.replace(t,function(e){var t=n[e];return"string"==typeof t?t:"\\"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}):e}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=e("quoted-printable"),a=void 0,u=void 0,f=void 0;!function(){if(void 0!=root&&(a=root.mhtml2html),void 0!==e){var t=e,n=t("jsdom").jsdom;u=t("btoa"),f=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(void 0,t.concat([{}]))}}else{var r=new DOMParser;u=btoa,f=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.parseFromString.apply(r,t.concat(["text/html"]))}}}();var c={noConflict:function(){return root.mhtml2html=a,c},parse:function(e){function t(){for(;r(M<e.length-1,"Unexpected EOF"),/\s/.test(e[M]);)M++,"\n"==e[M]&&E++}function n(t){var n;for(T=M;;){if("\n"==e[M]){M++,E++;break}r(M++<e.length-1,"Unexpected EOF")}switch(n=e.substring(T,M),t){case"quoted-printable":return d.decode(n);case"base64":return n.trim();default:return n}}function o(e,t){var n=e.split(/[:=](.+)?/);r(n.length>=2,"Invalid header; Line "+E),t[n[0].trim()]=n[1].trim()}var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={MHTML_HEADERS:0,MTHML_CONTENT:1,MHTML_DATA:2,MHTML_END:3},u=void 0,c=void 0,s=void 0,l=void 0,p=void 0,v=void 0,h=void 0,g=void 0,y=void 0,b=void 0,m=void 0,x=void 0,M=void 0,T=void 0,E=void 0,L=void 0;for(c={},s={},l={},p={},b=a.MHTML_HEADERS,M=E=0;b!=a.MHTML_END;)switch(b){case a.MHTML_HEADERS:m=n(),0!=m&&"\n"!=m?o(m,c):(L=c.boundary,r(void 0!==L,"Missing boundary from document headers; Line "+E),L=L.replace(/\"/g,""),t(),m=n(),r(m.includes(L),"Expected boundary; Line "+E),s={},b=a.MTHML_CONTENT);break;case a.MTHML_CONTENT:m=n(),0!=m&&"\n"!=m?o(m,s):(h=s["Content-Transfer-Encoding"],g=s["Content-Type"],y=s["Content-ID"],v=s["Content-Location"],void 0===x&&(x=v,r(void 0!==x&&"text/html"===g,"Index not found; Line "+E)),r(void 0!==y||void 0!==v,"ID or location header not provided;  Line "+E),r(void 0!==h,"Content-Transfer-Encoding not provided;  Line "+E),r(void 0!==g,"Content-Type not provided; Line "+E),u={encoding:h,type:g,data:"",id:y},void 0!==y&&(p[y]=u),void 0!==v&&void 0===l[v]&&(l[v]=u),t(),s={},b=a.MHTML_DATA);break;case a.MHTML_DATA:for(m=n(h);!m.includes(L);)u.data+=m,m=n(h);try{u.data=decodeURIComponent(escape(u.data))}catch(e){}if(!0===i&&void 0!==x)return f(u.data);b=M>=e.length-1?a.MHTML_END:a.MTHML_CONTENT}return{frames:p,media:l,index:x}},convert:function(e){function t(e,t){function n(n){o=e.split("/"),i=t.split("/"),n&&o.pop();for(var r=0;r<i.length;r++)".."==i[r]?o.pop():"."!=i[r]&&o.push(i[r]);return o.join("/")}var r,o,i,d;return/^((http|https|ftp):\/\/)/.test(t)?t:"/"==t[0]?(r=e.match(new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?")),r[2]+"://"+r[4]+t):(d=n(),null==s[d]?n(!0):d)}function n(e,n){var r,i;return p=n.substring(v,n.indexOf(")",v)),v+=p.length,r=t(e,p.replace(/(\"|\')/g,"")),null==s[r]?null:(p="url('data:"+s[r].type+";base64,"+("base64"===s[r].encoding?s[r].data:u(unescape(encodeURIComponent(o(s[r].data)))))+"')",i=v,v=h+p.length,""+n.substring(0,h)+p+n.substring(i+1))}var a=void 0,s=void 0,l=void 0,p=void 0,v=void 0,h=void 0;return(void 0===e?"undefined":i(e))===i("")?e=c.parse(e):r((void 0===e?"undefined":i(e))===i({}),"Expected argument of type string or object"),l=e.frames,s=e.media,a=e.index,r((void 0===l?"undefined":i(l))===i({}),"MHTML error: invalid frames"),r((void 0===s?"undefined":i(s))===i({}),"MHTML error: invalid media"),r((void 0===a?"undefined":i(a))===i(" "),"MHTML error: invalid index"),r(s[a]&&"text/html"===s[a].type,"MHTML error: invalid index"),function(e){var t=void 0,r=void 0,i=void 0,f=void 0,c=void 0,l=void 0,g=void 0;for(i=[e];i.length;){for(t=i.shift(),r=new Array(Object.keys(t.childNodes).length),v=0;v<r.length;v++)r[v]=t.childNodes[v];r.forEach(function(r){switch(r.getAttribute&&(c=r.getAttribute("href"),l=r.getAttribute("src")),r.tagName){case"HEAD":f=e.createElement("base"),f.setAttribute("target","_parent"),r.insertBefore(f,r.firstChild);break;case"LINK":if(void 0!==s[c]&&"text/css"===s[c].type){for(g=e.createElement("style"),g.type="text/css",v=0;(v=s[c].data.indexOf("url(",v))>0;)h=v,v+="url(".length,null!=(p=n(c,s[c].data))&&(s[c].data=p);g.appendChild(e.createTextNode(o(s[c].data))),t.replaceChild(g,r)}break;case"IMG":if(void 0!==s[l]&&s[l].type.includes("image")){switch(s[l].encoding){case"quoted-printable":p="data:"+s[l].type+";utf8,"+d.decode(s[l].data);break;case"base64":p="data:"+s[l].type+";base64,"+s[l].data;break;default:p="data:"+s[l].type+";base64,"+u(unescape(encodeURIComponent(o(s[l].data))))}r.setAttribute("src",p)}default:for(g in r.style)if("string"==typeof r.style[g])for(;(v=r.style[g].indexOf("url(",v))>0;)h=v,v+="url(".length,null!=(p=n(a,r.style[g]))&&(r.style[g]=p)}r.removeAttribute&&r.removeAttribute("integrity"),i.push(r)})}return e}(f(s[a].data))}};t.exports=c},{"quoted-printable":1}]},{},[2]);