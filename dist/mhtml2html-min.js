"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e){function t(e,t){if(!e)throw new Error(t)}function n(e){var t=/[\\\"\x00-\x1f\x7f-\uffff]/g,n={"\b":"\b","\t":"\t","\n":"\n","\f":"\f","\r":"\r",'"':'"',"\\":"\\"};return t.lastIndex=0,t.test(e)?e.replace(t,function(e){var t=n[e];return"string"==typeof t?t:"\\"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}):e}var o="url(",r="        /* MyCache CSS Reset:  */                                /* http://meyerweb.com/eric/tools/css/reset/ */          html, body, div, span, applet, object, iframe,           blockquote, pre,                                         a, abbr, acronym, address, big, cite, code,              del, dfn, em, img, ins, kbd, q, s, samp,                 small, strike, strong, sub, sup, tt, var,                b, u, i, center,                                         dl, dt, dd, ol, ul, li,                                  fieldset, form, label, legend,                           table, caption, tbody, tfoot, thead, tr, th, td,         article, aside, canvas, details, embed,                  figure, figcaption, footer, header, hgroup,              menu, nav, output, ruby, section, summary,               time, mark, audio, video {                                   margin: 0;                                               padding: 0;                                              border: 0;                                               font-size: 100%;                                         font: inherit;                                           vertical-align: baseline;                            }                                                        h1, h2, h3, h4, h5, h6, p {                                  padding: 0;                                              border: 0;                                               font-size: 100%;                                         font: inherit;                                           vertical-align: baseline;                            }                                                        article, aside, details, figcaption, figure,             footer, header, hgroup, menu, nav, section {                 display: block;                                      }                                                        body {                                                       line-height: 1;                                      }                                                        ol, ul {                                                     list-style: none;                                    }                                                        blockquote, q {                                              quotes: none;                                        }                                                        blockquote:before, blockquote:after,                     q:before, q:after {                                          content: '';                                           content: none;                                       }                                                        strong, b {                                                  font-weight: bold;                                   }                                                        table {                                                      border-collapse: collapse;                               border-spacing: 0;                                   }",i=void 0,d=void 0;void 0!=e&&(i=e.mhtml2html),d=function(){var e=String.fromCharCode,t=function(t){return t.replace(/[\t\x20]$/gm,"").replace(/=(?:\r\n?|\n|$)/g,"").replace(/=([a-fA-F0-9]{2})/g,function(t,n){var o=parseInt(n,16);return e(o)})},n=function(e){return e.replace(/\x20$/,"=20").replace(/\t$/,"=09")},o=/[\0-\x08\n-\x1F=\x7F-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,r=function(e){for(var t=e.replace(o,function(e){if(e>"ÿ")throw RangeError("`quotedPrintable.encode()` expects extended ASCII input only. Don’t forget to encode the input first using a character encoding like UTF-8.");var t=e.charCodeAt(0),n=t.toString(16).toUpperCase();return"="+("0"+n).slice(-2)}),r=t.split(/\r\n?|\n/g),i=-1,d=r.length,a=[];++i<d;)for(var s=r[i],f=75,l=0,u=s.length;l<u;){var c=t.slice(l,l+f);/=$/.test(c)?(c=c.slice(0,f-1),l+=f-1):/=[A-F0-9]$/.test(c)?(c=c.slice(0,f-2),l+=f-2):l+=f,a.push(c)}var p=c.length;return/[\t\x20]$/.test(c)&&(a.pop(),p+2<=f+1?a.push(n(c)):a.push(c.slice(0,p-1),n(c.slice(p-1,p)))),a.join("=\r\n")};return{encode:r,decode:t,version:"1.0.0"}}();var a={noConflict:function(){return e.mhtml2html=i,a},parse:function(e){function n(){for(;t(M<e.length-1,"Unexpected EOF"),/\s/.test(e[M]);)M++,"\n"==e[M]&&T++}function o(n){var o;for(x=M;;){if("\n"==e[M]){M++,T++;break}t(M++<e.length-1,"Unexpected EOF")}switch(o=e.substring(x,M),n){case"quoted-printable":return d.decode(o);case"base64":return o.trim();default:return o}}function r(e,n){var o=e.split(/[:=](.+)?/);t(o.length>=2,"Invalid header; Line "+T),n[o[0].trim()]=o[1].trim()}var i=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],a={MHTML_HEADERS:0,MTHML_CONTENT:1,MHTML_DATA:2,MHTML_END:3},s=void 0,f=void 0,l=void 0,u=void 0,c=void 0,p=void 0,h=void 0,v=void 0,g=void 0,y=void 0,m=void 0,b=void 0,M=void 0,x=void 0,T=void 0,_=void 0,C=void 0;for(f={},l={},u={},c={},y=a.MHTML_HEADERS,M=T=0;y!=a.MHTML_END;)switch(y){case a.MHTML_HEADERS:m=o(),0!=m&&"\n"!=m?r(m,f):(_=f.boundary,t(void 0!==_,"Missing boundary from document headers; Line "+T),_=_.replace(/\"/g,""),n(),m=o(),t(m.includes(_),"Expected boundary; Line "+T),l={},y=a.MTHML_CONTENT);break;case a.MTHML_CONTENT:m=o(),0!=m&&"\n"!=m?r(m,l):(h=l["Content-Transfer-Encoding"],v=l["Content-Type"],g=l["Content-ID"],p=l["Content-Location"],void 0===b&&(b=p,t(void 0!==b&&"text/html"===v,"Index not found; Line "+T)),t(void 0!==g||void 0!==p,"ID or location header not provided;  Line "+T),t(void 0!==h,"Content-Transfer-Encoding not provided;  Line "+T),t(void 0!==v,"Content-Type not provided; Line "+T),s={encoding:h,type:v,data:"",id:g},void 0!==g&&(c[g]=s),void 0!==p&&void 0===u[p]&&(u[p]=s),n(),l={},y=a.MHTML_DATA);break;case a.MHTML_DATA:for(m=o(h);!m.includes(_);)s.data+=m,m=o(h);try{s.data=decodeURIComponent(escape(s.data))}catch(e){}if(i===!0&&void 0!==b)return C=new DOMParser,C.parseFromString(s.data,"text/html");y=M>=e.length-1?a.MHTML_END:a.MTHML_CONTENT}return{frames:c,media:u,index:b}},convert:function(e){function i(e,t){function n(n){r=e.split("/"),i=t.split("/"),n&&r.pop();for(var o=0;o<i.length;o++)".."==i[o]?r.pop():"."!=i[o]&&r.push(i[o]);return r.join("/")}var o,r,i,d;return/^((http|https|ftp):\/\/)/.test(t)?t:"/"==t[0]?(o=e.match(new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?")),o[2]+"://"+o[4]+t):(d=n(),null==l[d]?n(!0):d)}function d(e,t){var n,o;return p=t.substring(h,t.indexOf(")",h)),h+=p.length,n=i(e,p.replace(/(\"|\')/g,"")),null==l[n]?null:(p="url('data:"+l[n].type+";base64,"+("base64"===l[n].encoding?l[n].data:g(l[n].data))+"')",o=h,h=v+p.length,""+t.substring(0,v)+p+t.substring(o+1))}function s(e){var t,i,a,s,u,c,g,y;for(a=[e],s=e.createElement("style"),s.type="text/css",s.styleSheet?s.styleSheet.cssText=r:s.appendChild(e.createTextNode(r));a.length;){for(t=a.shift(),i=new Array(Object.keys(t.childNodes).length),h=0;h<i.length;h++)i[h]=t.childNodes[h];i.forEach(function(t){if("HEAD"===t.tagName&&(t.insertBefore(s,t.firstChild),u=e.createElement("base"),u.setAttribute("target","_parent"),t.insertBefore(u,t.firstChild)),t.getAttribute){if(c=t.getAttribute("href"),g=t.getAttribute("src"),c&&l[c]){if("text/css"===l[c].type)for(h=0;(h=l[c].data.indexOf(o,h))>0;)v=h,h+=o.length,p=d(c,l[c].data),null!=p&&(l[c].data=p);t.setAttribute("href","data:"+l[c].type+";"+l[c].encoding+","+encodeURIComponent(n(l[c].data)))}g&&l[g]&&t.setAttribute("src","data:"+l[g].type+";"+l[g].encoding+","+encodeURIComponent(l[g].data));for(y in t.style)if(_typeof(t.style[y])===_typeof(""))for(;(h=t.style[y].indexOf(o,h))>0;)v=h,h+=o.length,p=d(f,t.style[y]),null!=p&&(t.style[y]=p)}t.removeAttribute&&t.removeAttribute("integrity"),a.push(t)})}return e}var f,l,u,c,p,h,v;if(("undefined"==typeof e?"undefined":_typeof(e))===_typeof("")?e=a.parse(e):t(("undefined"==typeof e?"undefined":_typeof(e))===_typeof({}),"Expected argument of type string or object"),u=e.frames,l=e.media,f=e.index,t(("undefined"==typeof u?"undefined":_typeof(u))===_typeof({}),"MHTML error: invalid frames"),t(("undefined"==typeof l?"undefined":_typeof(l))===_typeof({}),"MHTML error: invalid media"),t(("undefined"==typeof f?"undefined":_typeof(f))===_typeof(" "),"MHTML error: invalid index"),t(l[f]&&"text/html"===l[f].type,"MHTML error: invalid index"),"undefined"==typeof g){t("undefined"!=typeof require,"Require is not defined.");var g=require("btoa")}return"undefined"==typeof DOMParser?(t("undefined"!=typeof require,"Require is not defined."),c=require("jsdom").jsdom,s(c(l[f].data,{}))):(c=new DOMParser,s(c.parseFromString(l[f].data,"text/html")))}};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=a),exports.mhtml2html=a):void 0!=e&&(e.mhtml2html=a)}(void 0);