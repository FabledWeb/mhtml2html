!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.mhtml2html=t()}}(function(){var t;return function t(e,n,r){function o(s,a){if(!n[s]){if(!e[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[s]={exports:{}};e[s][0].call(f.exports,function(t){var n=e[s][1][t];return o(n||t)},f,f.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,n,r){(function(e){!function(o){function i(t){throw new RangeError(F[t])}function s(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function a(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(U,"."),r+s(t.split("."),e).join(".")}function h(t){for(var e,n,r=[],o=0,i=t.length;o<i;)e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<i?(n=t.charCodeAt(o++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),o--)):r.push(e);return r}function u(t){return s(t,function(t){var e="";return t>65535&&(t-=65536,e+=D(t>>>10&1023|55296),t=56320|1023&t),e+=D(t)}).join("")}function f(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:j}function c(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function l(t,e,n){var r=0;for(t=n?S(t/T):t>>1,t+=S(t/e);t>H*A>>1;r+=j)t=S(t/H);return S(r+(H+1)*t/(t+M))}function p(t){var e,n,r,o,s,a,h,c,p,d,v=[],m=t.length,y=0,g=E,b=I;for(n=t.lastIndexOf(q),n<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&i("not-basic"),v.push(t.charCodeAt(r));for(o=n>0?n+1:0;o<m;){for(s=y,a=1,h=j;o>=m&&i("invalid-input"),c=f(t.charCodeAt(o++)),(c>=j||c>S((O-y)/a))&&i("overflow"),y+=c*a,p=h<=b?C:h>=b+A?A:h-b,!(c<p);h+=j)d=j-p,a>S(O/d)&&i("overflow"),a*=d;e=v.length+1,b=l(y-s,e,0==s),S(y/e)>O-g&&i("overflow"),g+=S(y/e),y%=e,v.splice(y++,0,g)}return u(v)}function d(t){var e,n,r,o,s,a,u,f,p,d,v,m,y,g,b,x=[];for(t=h(t),m=t.length,e=E,n=0,s=I,a=0;a<m;++a)(v=t[a])<128&&x.push(D(v));for(r=o=x.length,o&&x.push(q);r<m;){for(u=O,a=0;a<m;++a)(v=t[a])>=e&&v<u&&(u=v);for(y=r+1,u-e>S((O-n)/y)&&i("overflow"),n+=(u-e)*y,e=u,a=0;a<m;++a)if(v=t[a],v<e&&++n>O&&i("overflow"),v==e){for(f=n,p=j;d=p<=s?C:p>=s+A?A:p-s,!(f<d);p+=j)b=f-d,g=j-d,x.push(D(c(d+b%g,0))),f=S(b/g);x.push(D(c(f,0))),s=l(n,y,r==o),n=0,++r}++n,++e}return x.join("")}function v(t){return a(t,function(t){return L.test(t)?p(t.slice(4).toLowerCase()):t})}function m(t){return a(t,function(t){return N.test(t)?"xn--"+d(t):t})}var y="object"==typeof r&&r&&!r.nodeType&&r,g="object"==typeof n&&n&&!n.nodeType&&n,b="object"==typeof e&&e;b.global!==b&&b.window!==b&&b.self!==b||(o=b);var x,w,O=2147483647,j=36,C=1,A=26,M=38,T=700,I=72,E=128,q="-",L=/^xn--/,N=/[^\x20-\x7E]/,U=/[\x2E\u3002\uFF0E\uFF61]/g,F={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},H=j-C,S=Math.floor,D=String.fromCharCode;if(x={version:"1.4.1",ucs2:{decode:h,encode:u},decode:p,encode:d,toASCII:m,toUnicode:v},"function"==typeof t&&"object"==typeof t.amd&&t.amd)t("punycode",function(){return x});else if(y&&g)if(n.exports==y)g.exports=x;else for(w in x)x.hasOwnProperty(w)&&(y[w]=x[w]);else o.punycode=x}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,i){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var h=1e3;i&&"number"==typeof i.maxKeys&&(h=i.maxKeys);var u=t.length;h>0&&u>h&&(u=h);for(var f=0;f<u;++f){var c,l,p,d,v=t[f].replace(a,"%20"),m=v.indexOf(n);m>=0?(c=v.substr(0,m),l=v.substr(m+1)):(c=v,l=""),p=decodeURIComponent(c),d=decodeURIComponent(l),r(s,p)?o(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],3:[function(t,e,n){"use strict";function r(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var o=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?r(s(t),function(s){var a=encodeURIComponent(o(s))+n;return i(t[s])?r(t[s],function(t){return a+encodeURIComponent(o(t))}).join(e):a+encodeURIComponent(o(t[s]))}).join(e):a?encodeURIComponent(o(a))+n+encodeURIComponent(o(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],4:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":2,"./encode":3}],5:[function(e,n,r){(function(e){!function(o){var i="object"==typeof r&&r,s="object"==typeof n&&n&&n.exports==i&&n,a="object"==typeof e&&e;a.global!==a&&a.window!==a||(o=a);var h=String.fromCharCode,u=function(t){return t.replace(/[\t\x20]$/gm,"").replace(/=(?:\r\n?|\n|$)/g,"").replace(/=([a-fA-F0-9]{2})/g,function(t,e){var n=parseInt(e,16);return h(n)})},f=function(t){return t.replace(/\x20$/,"=20").replace(/\t$/,"=09")},c=/[\0-\x08\n-\x1F=\x7F-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,l=function(t){for(var e=t.replace(c,function(t){if(t>"ÿ")throw RangeError("`quotedPrintable.encode()` expects extended ASCII input only. Don’t forget to encode the input first using a character encoding like UTF-8.");return"="+("0"+t.charCodeAt(0).toString(16).toUpperCase()).slice(-2)}),n=e.split(/\r\n?|\n/g),r=-1,o=n.length,i=[];++r<o;)for(var s=n[r],a=75,h=0,u=s.length;h<u;){var l=e.slice(h,h+a);/=$/.test(l)?(l=l.slice(0,a-1),h+=a-1):/=[A-F0-9]$/.test(l)?(l=l.slice(0,a-2),h+=a-2):h+=a,i.push(l)}var p=l.length;return/[\t\x20]$/.test(l)&&(i.pop(),p+2<=a+1?i.push(f(l)):i.push(l.slice(0,p-1),f(l.slice(p-1,p)))),i.join("=\r\n")},p={encode:l,decode:u,version:"1.0.1"};if("function"==typeof t&&"object"==typeof t.amd&&t.amd)t(function(){return p});else if(i&&!i.nodeType)if(s)s.exports=p;else for(var d in p)p.hasOwnProperty(d)&&(i[d]=p[d]);else o.quotedPrintable=p}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,e,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,n){if(t&&u.isObject(t)&&t instanceof r)return t;var o=new r;return o.parse(t,e,n),o}function i(t){return u.isString(t)&&(t=o(t)),t instanceof r?t.format():r.prototype.format.call(t)}function s(t,e){return o(t,!1,!0).resolve(e)}function a(t,e){return t?o(t,!1,!0).resolveObject(e):e}var h=t("punycode"),u=t("./util");n.parse=o,n.resolve=s,n.resolveObject=a,n.format=i,n.Url=r;var f=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(p),v=["'"].concat(d),m=["%","/","?",";","#"].concat(v),y=["/","?","#"],g=/^[+a-z0-9A-Z_-]{0,63}$/,b=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},w={javascript:!0,"javascript:":!0},O={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},j=t("querystring");r.prototype.parse=function(t,e,n){if(!u.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),o=-1!==r&&r<t.indexOf("#")?"?":"#",i=t.split(o),s=/\\/g;i[0]=i[0].replace(s,"/"),t=i.join(o);var a=t;if(a=a.trim(),!n&&1===t.split("#").length){var c=l.exec(a);if(c)return this.path=a,this.href=a,this.pathname=c[1],c[2]?(this.search=c[2],this.query=e?j.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var p=f.exec(a);if(p){p=p[0];var d=p.toLowerCase();this.protocol=d,a=a.substr(p.length)}if(n||p||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var C="//"===a.substr(0,2);!C||p&&w[p]||(a=a.substr(2),this.slashes=!0)}if(!w[p]&&(C||p&&!O[p])){for(var A=-1,M=0;M<y.length;M++){var T=a.indexOf(y[M]);-1!==T&&(-1===A||T<A)&&(A=T)}var I,E;E=-1===A?a.lastIndexOf("@"):a.lastIndexOf("@",A),-1!==E&&(I=a.slice(0,E),a=a.slice(E+1),this.auth=decodeURIComponent(I)),A=-1;for(var M=0;M<m.length;M++){var T=a.indexOf(m[M]);-1!==T&&(-1===A||T<A)&&(A=T)}-1===A&&(A=a.length),this.host=a.slice(0,A),a=a.slice(A),this.parseHost(),this.hostname=this.hostname||"";var q="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!q)for(var L=this.hostname.split(/\./),M=0,N=L.length;M<N;M++){var U=L[M];if(U&&!U.match(g)){for(var F="",H=0,S=U.length;H<S;H++)U.charCodeAt(H)>127?F+="x":F+=U[H];if(!F.match(g)){var D=L.slice(0,M),R=L.slice(M+1),_=U.match(b);_&&(D.push(_[1]),R.unshift(_[2])),R.length&&(a="/"+R.join(".")+a),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),q||(this.hostname=h.toASCII(this.hostname));var k=this.port?":"+this.port:"",$=this.hostname||"";this.host=$+k,this.href+=this.host,q&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!x[d])for(var M=0,N=v.length;M<N;M++){var P=v[M];if(-1!==a.indexOf(P)){var z=encodeURIComponent(P);z===P&&(z=escape(P)),a=a.split(P).join(z)}}var K=a.indexOf("#");-1!==K&&(this.hash=a.substr(K),a=a.slice(0,K));var B=a.indexOf("?");if(-1!==B?(this.search=a.substr(B),this.query=a.substr(B+1),e&&(this.query=j.parse(this.query)),a=a.slice(0,B)):e&&(this.search="",this.query={}),a&&(this.pathname=a),O[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var k=this.pathname||"",Z=this.search||"";this.path=k+Z}return this.href=this.format(),this},r.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&u.isObject(this.query)&&Object.keys(this.query).length&&(i=j.stringify(this.query));var s=this.search||i&&"?"+i||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||O[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+o+n+s+r},r.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},r.prototype.resolveObject=function(t){if(u.isString(t)){var e=new r;e.parse(t,!1,!0),t=e}for(var n=new r,o=Object.keys(this),i=0;i<o.length;i++){var s=o[i];n[s]=this[s]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),h=0;h<a.length;h++){var f=a[h];"protocol"!==f&&(n[f]=t[f])}return O[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!O[t.protocol]){for(var c=Object.keys(t),l=0;l<c.length;l++){var p=c[l];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||w[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var v=n.pathname||"",m=n.search||"";n.path=v+m}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var y=n.pathname&&"/"===n.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=g||y||n.host&&t.pathname,x=b,j=n.pathname&&n.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],C=n.protocol&&!O[n.protocol];if(C&&(n.hostname="",n.port=null,n.host&&(""===j[0]?j[0]=n.host:j.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),b=b&&(""===d[0]||""===j[0])),g)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,j=d;else if(d.length)j||(j=[]),j.pop(),j=j.concat(d),n.search=t.search,n.query=t.query;else if(!u.isNullOrUndefined(t.search)){if(C){n.hostname=n.host=j.shift();var A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");A&&(n.auth=A.shift(),n.host=n.hostname=A.shift())}return n.search=t.search,n.query=t.query,u.isNull(n.pathname)&&u.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!j.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var M=j.slice(-1)[0],T=(n.host||t.host||j.length>1)&&("."===M||".."===M)||""===M,I=0,E=j.length;E>=0;E--)M=j[E],"."===M?j.splice(E,1):".."===M?(j.splice(E,1),I++):I&&(j.splice(E,1),I--);if(!b&&!x)for(;I--;I)j.unshift("..");!b||""===j[0]||j[0]&&"/"===j[0].charAt(0)||j.unshift(""),T&&"/"!==j.join("/").substr(-1)&&j.push("");var q=""===j[0]||j[0]&&"/"===j[0].charAt(0);if(C){n.hostname=n.host=q?"":j.length?j.shift():"";var A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");A&&(n.auth=A.shift(),n.host=n.hostname=A.shift())}return b=b||n.host&&j.length,b&&!q&&j.unshift(""),j.length?n.pathname=j.join("/"):(n.pathname=null,n.path=null),u.isNull(n.pathname)&&u.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var t=this.host,e=c.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":7,punycode:1,querystring:4}],7:[function(t,e,n){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],8:[function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e);return!0}function o(t){var e=/[\\\"\x00-\x1f\x7f-\uffff]/g,n={"\b":"\b","\t":"\t","\n":"\n","\f":"\f","\r":"\r",'"':'"',"\\":"\\"};return e.lastIndex=0,e.test(t)?t.replace(e,function(t){var e=n[t];return"string"==typeof e?e:"\\"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}):t}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=t("quoted-printable"),a=t("url"),h=void 0,u=void 0,f=void 0;!function(){"undefined"!=typeof window&&(h=window.mhtml2html);var e=void 0!==t?t:null;if("undefined"==typeof DOMParser){var n=e("jsdom").jsdom;f=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.apply(void 0,e.concat([{}]))}}else{var r=new DOMParser;f=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.parseFromString.apply(r,e.concat(["text/html"]))}}u="undefined"==typeof btoa?e("btoa"):btoa}();var c={noConflict:function(){return"undefined"!=typeof window&&(window.mhtml2html=h),c},parse:function(t){function e(){for(;r(w<t.length-1,"Unexpected EOF")&&/\s/.test(t[w]);)"\n"==t[++w]&&O++}function n(e){for(var n=w;"\n"!==t[w]&&r(w++<t.length-1,"Unexpected EOF"););w++,O++;var o=t.substring(n,w);switch(e){case"quoted-printable":return s.decode(o);case"base64":return o.trim();default:return o}}function o(t,e){var n=t.split(/[:=](.+)?/);r(n.length>=2,"Invalid header; Line "+O),e[n[0].trim()]=n[1].trim()}var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={MHTML_HEADERS:0,MTHML_CONTENT:1,MHTML_DATA:2,MHTML_END:3},h=void 0,u=void 0,c=void 0,l=void 0,p=void 0,d=void 0,v=void 0,m=void 0,y=void 0,g=void 0,b=void 0,x=void 0,w=void 0,O=void 0,j=void 0;for(u={},c={},l={},p={},g=a.MHTML_HEADERS,w=O=0;g!=a.MHTML_END;)switch(g){case a.MHTML_HEADERS:b=n(),0!=b&&"\n"!=b?o(b,u):(j=u.boundary,r(void 0!==j,"Missing boundary from document headers; Line "+O),j=j.replace(/\"/g,""),e(),b=n(),r(b.includes(j),"Expected boundary; Line "+O),c={},g=a.MTHML_CONTENT);break;case a.MTHML_CONTENT:b=n(),0!=b&&"\n"!=b?o(b,c):(v=c["Content-Transfer-Encoding"],m=c["Content-Type"],y=c["Content-ID"],d=c["Content-Location"],void 0===x&&(x=d,r(void 0!==x&&"text/html"===m,"Index not found; Line "+O)),r(void 0!==y||void 0!==d,"ID or location header not provided;  Line "+O),r(void 0!==v,"Content-Transfer-Encoding not provided;  Line "+O),r(void 0!==m,"Content-Type not provided; Line "+O),h={encoding:v,type:m,data:"",id:y},void 0!==y&&(p[y]=h),void 0!==d&&void 0===l[d]&&(l[d]=h),e(),c={},g=a.MHTML_DATA);break;case a.MHTML_DATA:for(b=n(v);!b.includes(j);)h.data+=b,b=n(v);try{h.data=decodeURIComponent(escape(h.data))}catch(t){}if(!0===i&&void 0!==x)return f(h.data);g=w>=t.length-1?a.MHTML_END:a.MTHML_CONTENT}return{frames:p,media:l,index:x}},convert:function(t){function e(t,e){var n=void 0,r=void 0;return p=e.substring(d,e.indexOf(")",d)),d+=p.length,n=a.resolve(t,p.replace(/(\"|\')/g,"")),null==h[n]?e:(p="url('data:"+h[n].type+";base64,"+("base64"===h[n].encoding?h[n].data:u(unescape(encodeURIComponent(o(h[n].data)))))+"')",r=d,d=v+p.length,""+e.substring(0,v)+p+e.substring(r+1))}var n=void 0,h=void 0,l=void 0,p=void 0,d=void 0,v=void 0;return(void 0===t?"undefined":i(t))===i("")?t=c.parse(t):r((void 0===t?"undefined":i(t))===i({}),"Expected argument of type string or object"),l=t.frames,h=t.media,n=t.index,r((void 0===l?"undefined":i(l))===i({}),"MHTML error: invalid frames"),r((void 0===h?"undefined":i(h))===i({}),"MHTML error: invalid media"),r((void 0===n?"undefined":i(n))===i(" "),"MHTML error: invalid index"),r(h[n]&&"text/html"===h[n].type,"MHTML error: invalid index"),function(t){var r=void 0,i=void 0,a=void 0,f=void 0,c=void 0,l=void 0;for(r=[t];r.length;)a=r.shift(),a.childNodes.forEach(function(m){switch(m.getAttribute&&(f=m.getAttribute("href"),c=m.getAttribute("src")),m.removeAttribute&&m.removeAttribute("integrity"),m.tagName){case"HEAD":i=t.createElement("base"),i.setAttribute("target","_parent"),m.insertBefore(i,m.firstChild);break;case"LINK":if(void 0!==h[f]&&"text/css"===h[f].type){for(l=t.createElement("style"),l.type="text/css",d=0;(d=h[f].data.indexOf("url(",d))>0;)v=d,d+="url(".length,h[f].data=e(f,h[f].data);l.appendChild(t.createTextNode(o(h[f].data))),a.replaceChild(l,m)}break;case"IMG":if(void 0!==h[c]&&h[c].type.includes("image")){switch(h[c].encoding){case"quoted-printable":p="data:"+h[c].type+";utf8,"+s.decode(h[c].data);break;case"base64":p="data:"+h[c].type+";base64,"+h[c].data;break;default:p="data:"+h[c].type+";base64,"+u(unescape(encodeURIComponent(o(h[c].data))))}m.setAttribute("src",p)}break;default:for(l in m.style)if("string"==typeof m.style[l])for(;(d=m.style[l].indexOf("url(",d))>0;)v=d,d+="url(".length,m.style[l]=e(n,m.style[l])}r.push(m)});return t}(f(h[n].data))}};e.exports=c},{"quoted-printable":5,url:6}]},{},[8])(8)});