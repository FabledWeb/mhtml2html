!function e(t,n,o){function r(d,a){if(!n[d]){if(!t[d]){var f="function"==typeof require&&require;if(!a&&f)return f(d,!0);if(i)return i(d,!0);var u=new Error("Cannot find module '"+d+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[d]={exports:{}};t[d][0].call(c.exports,function(e){var n=t[d][1][e];return r(n||e)},c,c.exports,e,t,n,o)}return n[d].exports}for(var i="function"==typeof require&&require,d=0;d<o.length;d++)r(o[d]);return r}({1:[function(e,t,n){(function(e){!function(o){var r="object"==typeof n&&n,i="object"==typeof t&&t&&t.exports==r&&t,d="object"==typeof e&&e;d.global!==d&&d.window!==d||(o=d);var a=String.fromCharCode,f=function(e){return e.replace(/[\t\x20]$/gm,"").replace(/=(?:\r\n?|\n|$)/g,"").replace(/=([a-fA-F0-9]{2})/g,function(e,t){var n=parseInt(t,16);return a(n)})},u=function(e){return e.replace(/\x20$/,"=20").replace(/\t$/,"=09")},c=/[\0-\x08\n-\x1F=\x7F-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,l=function(e){for(var t=e.replace(c,function(e){if(e>"ÿ")throw RangeError("`quotedPrintable.encode()` expects extended ASCII input only. Don’t forget to encode the input first using a character encoding like UTF-8.");return"="+("0"+e.charCodeAt(0).toString(16).toUpperCase()).slice(-2)}),n=t.split(/\r\n?|\n/g),o=-1,r=n.length,i=[];++o<r;)for(var d=n[o],a=75,f=0,l=d.length;f<l;){var s=t.slice(f,f+a);/=$/.test(s)?(s=s.slice(0,a-1),f+=a-1):/=[A-F0-9]$/.test(s)?(s=s.slice(0,a-2),f+=a-2):f+=a,i.push(s)}var p=s.length;return/[\t\x20]$/.test(s)&&(i.pop(),p+2<=a+1?i.push(u(s)):i.push(s.slice(0,p-1),u(s.slice(p-1,p)))),i.join("=\r\n")},s={encode:l,decode:f,version:"1.0.1"};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return s});else if(r&&!r.nodeType)if(i)i.exports=s;else for(var p in s)s.hasOwnProperty(p)&&(r[p]=s[p]);else o.quotedPrintable=s}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";function o(e,t){if(!e)throw new Error(t)}function r(e){var t=/[\\\"\x00-\x1f\x7f-\uffff]/g,n={"\b":"\b","\t":"\t","\n":"\n","\f":"\f","\r":"\r",'"':'"',"\\":"\\"};return t.lastIndex=0,t.test(e)?e.replace(t,function(e){var t=n[e];return"string"==typeof t?t:"\\"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}):e}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=e("quoted-printable"),a=void 0,f=void 0,u=void 0;!function(){"undefined"!=typeof window&&(a=window.mhtml2html);var t=void 0!==e?e:null;if("undefined"==typeof DOMParser){var n=t("jsdom").jsdom;u=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.apply(void 0,t.concat([{}]))}}else{var o=new DOMParser;u=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.parseFromString.apply(o,t.concat(["text/html"]))}}f="undefined"==typeof btoa?t("btoa"):btoa}();var c={noConflict:function(){return"undefined"!=typeof window&&(window.mhtml2html=a),c},parse:function(e){function t(){for(;o(x<e.length-1,"Unexpected EOF"),/\s/.test(e[x]);)x++,"\n"==e[x]&&E++}function n(t){var n;for(T=x;;){if("\n"==e[x]){x++,E++;break}o(x++<e.length-1,"Unexpected EOF")}switch(n=e.substring(T,x),t){case"quoted-printable":return d.decode(n);case"base64":return n.trim();default:return n}}function r(e,t){var n=e.split(/[:=](.+)?/);o(n.length>=2,"Invalid header; Line "+E),t[n[0].trim()]=n[1].trim()}var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={MHTML_HEADERS:0,MTHML_CONTENT:1,MHTML_DATA:2,MHTML_END:3},f=void 0,c=void 0,l=void 0,s=void 0,p=void 0,v=void 0,h=void 0,y=void 0,g=void 0,b=void 0,m=void 0,M=void 0,x=void 0,T=void 0,E=void 0,w=void 0;for(c={},l={},s={},p={},b=a.MHTML_HEADERS,x=E=0;b!=a.MHTML_END;)switch(b){case a.MHTML_HEADERS:m=n(),0!=m&&"\n"!=m?r(m,c):(w=c.boundary,o(void 0!==w,"Missing boundary from document headers; Line "+E),w=w.replace(/\"/g,""),t(),m=n(),o(m.includes(w),"Expected boundary; Line "+E),l={},b=a.MTHML_CONTENT);break;case a.MTHML_CONTENT:m=n(),0!=m&&"\n"!=m?r(m,l):(h=l["Content-Transfer-Encoding"],y=l["Content-Type"],g=l["Content-ID"],v=l["Content-Location"],void 0===M&&(M=v,o(void 0!==M&&"text/html"===y,"Index not found; Line "+E)),o(void 0!==g||void 0!==v,"ID or location header not provided;  Line "+E),o(void 0!==h,"Content-Transfer-Encoding not provided;  Line "+E),o(void 0!==y,"Content-Type not provided; Line "+E),f={encoding:h,type:y,data:"",id:g},void 0!==g&&(p[g]=f),void 0!==v&&void 0===s[v]&&(s[v]=f),t(),l={},b=a.MHTML_DATA);break;case a.MHTML_DATA:for(m=n(h);!m.includes(w);)f.data+=m,m=n(h);try{f.data=decodeURIComponent(escape(f.data))}catch(e){}if(!0===i&&void 0!==M)return u(f.data);b=x>=e.length-1?a.MHTML_END:a.MTHML_CONTENT}return{frames:p,media:s,index:M}},convert:function(e){function t(e,t){function n(n){r=e.split("/"),i=t.split("/"),n&&r.pop();for(var o=0;o<i.length;o++)".."==i[o]?r.pop():"."!=i[o]&&r.push(i[o]);return r.join("/")}var o,r,i,d;return/^((http|https|ftp):\/\/)/.test(t)?t:"/"==t[0]?(o=e.match(new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?")),o[2]+"://"+o[4]+t):(d=n(),null==l[d]?n(!0):d)}function n(e,n){var o,i;return p=n.substring(v,n.indexOf(")",v)),v+=p.length,o=t(e,p.replace(/(\"|\')/g,"")),null==l[o]?null:(p="url('data:"+l[o].type+";base64,"+("base64"===l[o].encoding?l[o].data:f(unescape(encodeURIComponent(r(l[o].data)))))+"')",i=v,v=h+p.length,""+n.substring(0,h)+p+n.substring(i+1))}var a=void 0,l=void 0,s=void 0,p=void 0,v=void 0,h=void 0;return(void 0===e?"undefined":i(e))===i("")?e=c.parse(e):o((void 0===e?"undefined":i(e))===i({}),"Expected argument of type string or object"),s=e.frames,l=e.media,a=e.index,o((void 0===s?"undefined":i(s))===i({}),"MHTML error: invalid frames"),o((void 0===l?"undefined":i(l))===i({}),"MHTML error: invalid media"),o((void 0===a?"undefined":i(a))===i(" "),"MHTML error: invalid index"),o(l[a]&&"text/html"===l[a].type,"MHTML error: invalid index"),function(e){var t=void 0,o=void 0,i=void 0,u=void 0,c=void 0,s=void 0,y=void 0;for(i=[e];i.length;){for(t=i.shift(),o=new Array(Object.keys(t.childNodes).length),v=0;v<o.length;v++)o[v]=t.childNodes[v];o.forEach(function(o){switch(o.getAttribute&&(c=o.getAttribute("href"),s=o.getAttribute("src")),o.tagName){case"HEAD":u=e.createElement("base"),u.setAttribute("target","_parent"),o.insertBefore(u,o.firstChild);break;case"LINK":if(void 0!==l[c]&&"text/css"===l[c].type){for(y=e.createElement("style"),y.type="text/css",v=0;(v=l[c].data.indexOf("url(",v))>0;)h=v,v+="url(".length,null!=(p=n(c,l[c].data))&&(l[c].data=p);y.appendChild(e.createTextNode(r(l[c].data))),t.replaceChild(y,o)}break;case"IMG":if(void 0!==l[s]&&l[s].type.includes("image")){switch(l[s].encoding){case"quoted-printable":p="data:"+l[s].type+";utf8,"+d.decode(l[s].data);break;case"base64":p="data:"+l[s].type+";base64,"+l[s].data;break;default:p="data:"+l[s].type+";base64,"+f(unescape(encodeURIComponent(r(l[s].data))))}o.setAttribute("src",p)}default:for(y in o.style)if("string"==typeof o.style[y])for(;(v=o.style[y].indexOf("url(",v))>0;)h=v,v+="url(".length,null!=(p=n(a,o.style[y]))&&(o.style[y]=p)}o.removeAttribute&&o.removeAttribute("integrity"),i.push(o)})}return e}(u(l[a].data))}};t.exports=c},{"quoted-printable":1}]},{},[2]);